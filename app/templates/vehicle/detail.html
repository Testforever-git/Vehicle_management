{% extends 'base.html' %}
{% from 'macros/controls.html' import display_field with context %}
{% from 'macros/buttons.html' import action_button with context %}

{% set brand_label = (vehicle.brand_jp if lang == 'jp' else vehicle.brand_cn) or '-' %}
{% set model_label = (vehicle.model_jp if lang == 'jp' else vehicle.model_cn) or '-' %}
{% block page_title %}{{ brand_label }} / {{ model_label }}{% endblock %}

{% block content %}
<div class="row g-3">
  <div class="col-md-5">
    <div class="card p-3">
      <div class="ac-title-sub">{{ t('vehicle_detail.section_basic') }}</div>
      {{ display_field('vehicle','brand_id', t('vehicle_detail.brand'), brand_label, 'main') }}
      {{ display_field('vehicle','model_id', t('vehicle_detail.model'), model_label) }}
      {{ display_field('vehicle','type_designation_code', t('vehicle_detail.type_designation_code'), vehicle.type_designation_code) }}
      {{ display_field('vehicle','plate_no', t('vehicle_detail.plate_no'), vehicle.masked_plate_no) }}
      {{ display_field('vehicle','vin', t('vehicle_detail.vin'), vehicle.vin) }}
    </div>

    <div class="mt-2 d-flex gap-2">
      {{ action_button('vehicle','edit', t('vehicle_detail.edit'), url_for('ui.vehicle_edit', vehicle_id=vehicle.id, lang=lang)) }}
      <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('qr.qr_public', qr_slug='abc123', lang=lang) }}">
        {{ t('vehicle_detail.qr_demo') }}
      </a>
    </div>
  </div>

  <div class="col-md-7">
    <div class="card p-3">
      <div class="ac-title-sub">{{ t('vehicle_detail.section_status') }}</div>
      {% if status %}
        {{ display_field('vehicle_status','status', t('vehicle_detail.status'), status.status) }}
        {{ display_field('vehicle_status','mileage', t('vehicle_detail.mileage'), status.mileage ~ ' km') }}
        {{ display_field('vehicle_status','fuel_level', t('vehicle_detail.fuel_level'), status.fuel_level ~ ' %') }}
        {{ display_field('vehicle_status','location_desc', t('vehicle_detail.location_desc'), status.location_desc) }}
      {% else %}
        <p class="ac-text-meta">{{ t('vehicle_detail.no_status') }}</p>
      {% endif %}
    </div>

    <div class="card p-3 mt-3">
      <div class="ac-title-sub">{{ t('vehicle_detail.section_garage') }}</div>
      {{ display_field('vehicle','garage_name', t('vehicle_detail.garage_name'), vehicle.garage_name) }}
      {{ display_field('vehicle','garage_address_jp', t('vehicle_detail.garage_address_jp'), vehicle.garage_address_jp) }}
    </div>

    <div class="card p-3 mt-3">
      <div class="ac-title-sub">{{ t('vehicle_detail.section_files') }}</div>
      {{ display_field('vehicle','legal_doc', t('vehicle_detail.legal_doc_dir'), legal_docs | length) }}
      {{ display_field('vehicle','vehicle_photo', t('vehicle_detail.vehicle_photo_dir'), vehicle_photos | length) }}
      <p class="ac-text-meta mb-0">
        {{ t('vehicle_detail.files_hint') }}
      </p>
    </div>
  </div>
</div>
{% endblock %}
